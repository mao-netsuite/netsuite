/**
 * @preserve
 * 
 * @NApiVersion 2.1
 * @NScriptName E-Invoicing Vendor CS
 * @NScriptId _ei_vendor_cs
 * @NScriptType clientscript
 * @NModuleScope Public
 */

/*! For license information please see cs_vendor.js.LICENSE.txt */
define(["N/error","N/record","N/runtime","N/search","N/translation"],((e,t,n,r,i)=>{return s={4528:(e,t,n)=>{var r,i;r=[n(3899),n(3776),n(7903),n(9502)],void 0===(i=function(e,t,n,r){var i,s,a="customer.noemail",o="customer.contactnoemail",u="customer.norecipients",c="customer.maxrecipientexceeded",d="customer.nosenders",l="customer.existingsender",p="customer.existingdomain",g="customer.existingidentifier",_="vendor.noemail",v="vendor.contactnoemail",f="vendor.norecipients",m="vendor.maxrecipientexceeded",h="vendor.nosenders",y="vendor.existingsender",S="vendor.existingdomain",V="vendor.existingidentifier",x="msg_no_email",E="msg_contact_no_email",M="msg_no_recipients",I="msg_exceeded_recipients",R="msg_no_senders",N="msg_existing_sender",O="msg_existing_domain",b="msg_existing_vendor_id";function A(){var e=[a,o,u,c,d,l,p,g,_,v,f,m,h,y,S,V],t=r.getStringMap(e);i={},"vendor"==s?(i[x]=t[_],i[E]=t[v],i[M]=t[f],i[I]=t[m],i[R]=t[h],i[N]=t[y],i[O]=t[S],i[b]=t[V]):(i[x]=t[a],i[E]=t[o],i[M]=t[u],i[I]=t[c],i[R]=t[d],i[N]=t[l],i[O]=t[p],i[b]=t[g])}return{hasNoEmail:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[x]),t},hasNoRecipients:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[M]),t},hasNoSenders:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[R]),t},senderExists:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[N]),t},domainExists:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[O]),t},webServiceIdentifierExists:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[b]),t},validateContactsEmails:function(r){var s;if(i||A(),!r)throw s={name:"REQUIRED_PARAM_MISSING",message:"Contacts array required for validation.",notifyOff:!0},log.error(s.name,s.message),n.create(s);if(!util.isArray(r))throw s={name:"PARAM_IS_NOT_AN_ARRAY",message:"Contacts parameter is not an array.",notifyOff:!0},log.error(s.name,s.message),n.create(s);for(var a=!0,o=e.create(),u=[],c=0;c<r.length;c++){var d=r[c],l=d.getValue("email"),p=d.getValue("entityid");l||(a=!1,u.push(p))}if(o.setValidity(a),!o.isValid()){var g={CONTACTNAMES:u.join(", ")};t.setString(i[E]),t.replaceParameters(g),o.setMessage(t.toString())}return o},hasExceededRecipients:function(){i||A();var t=e.create();return t.setValidity(!1),t.setMessage(i[I]),t},setEntityType:function(e){i=null,s=e}}}.apply(t,r))||(e.exports=i)},3192:(e,t,n)=>{var r,i;r=[n(4528),n(8948),n(3623),n(5389)],void 0===(i=function(e,t,n,r){var i="vendor";return{validateIndividualVendor:function(t){e.setEntityType(i);var r=[];return t.getValue("email")||r.push(e.hasNoEmail()),n.consolidateValidationResults(r),n},validateRecipients:function(r,s,a){e.setEntityType(i);var o=[],u=r.getLineCount(s);if(u>10)o.push(e.hasExceededRecipients());else if(u>0){for(var c=[],d=0;d<u;d++){var l=r.getSublistValue({sublistId:s,fieldId:a,line:d});c.push(l)}var p=t.loadContacts(c);o.push(e.validateContactsEmails(p))}else o.push(e.hasNoRecipients());return n.consolidateValidationResults(o),n},validateSenders:function(t,r){e.setEntityType(i);var s=[];return t.getLineCount(r)<1&&s.push(e.hasNoSenders()),n.consolidateValidationResults(s),n},validateSenderEmail:function(t,s,a,o,u){e.setEntityType(i);var c,d=[];c=u===r.ContextType.USER_INTERFACE?t.getCurrentSublistValue({sublistId:s,fieldId:a}):t.getSublistValue({sublistId:s,fieldId:a,line:o});var l=t.findSublistLineWithValue({sublistId:s,fieldId:a,value:c});return-1!==l&&l!==o&&d.push(e.senderExists()),n.consolidateValidationResults(d),n},validateSenderDomain:function(r){e.setEntityType(i);var s=[],a=r.getValue("custentity_edoc_sender_domain");return a&&t.getVendorsUsingSenderDomain(a,r.id).length>0&&s.push(e.domainExists()),n.consolidateValidationResults(s),n},validateWebServiceIdentifier:function(r){e.setEntityType(i);var s=[],a=r.getValue("custentity_edoc_ws_id");return a&&t.getVendorsUsingWebServiceIdentifier(a,r.id).length>0&&s.push(e.webServiceIdentifierExists()),n.consolidateValidationResults(s),n}}}.apply(t,r))||(e.exports=i)},6228:(e,t,n)=>{var r,i;r=[n(3192),n(8521),n(5389)],void 0===(i=function(e,t,n){var r="recmachcustrecord_psg_ei_email_sender_vendor";return{saveRecord:function(n){var i=!0,s=n.currentRecord,a=s.getValue("custentity_psg_ei_entity_edoc_standard"),o=s.getValue("custentity_edoc_sender_domain"),u=s.getValue("custentity_edoc_use_sender_list"),c=s.getValue("custentity_edoc_ws_id");if(a){var d,l=function(e){var n=!1,r={edocumentstandard:e,sendingchannel:"email"};return t.getSendingMethods(r).length>0&&(n=!0),n}(a);l&&((d="T"===s.getValue("isperson")?e.validateIndividualVendor(s):e.validateRecipients(s,"recmachcustrecord_psg_ei_email_recipient_vendor","custrecord_psg_v_ei_email_recipient_cont")).isSuccessful()||(alert(d.getMessage()),i=!1))}if(!0===u){var p=e.validateSenders(s,r);p.isSuccessful()||(alert(p.getMessage()),i=!1)}if(o){var g=e.validateSenderDomain(s);g.isSuccessful()||(alert(g.getMessage()),i=!1)}if(c){var _=e.validateWebServiceIdentifier(s);_.isSuccessful()||(alert(_.getMessage()),i=!1)}return i},validateLine:function(t){var i=t.currentRecord,s=!0;if(t.sublistId===r){var a=i.getCurrentSublistIndex(r),o=e.validateSenderEmail(i,r,"custrecord_psg_ei_email_sender_email",a,n.executionContext);o.isSuccessful()||(alert(o.getMessage()),s=!1)}return s}}}.apply(t,r))||(e.exports=i)},8521:(e,t,n)=>{var r,i;r=[n(5239),n(1303)],void 0===(i=function(e,t){var n="customrecord_ei_sending_method",r={recordType:n,fieldMap:{edocumentstandard:"custrecord_psg_ei_edoc_standard",sendingscript:"custrecord_ei_sending_method_script",sendingchannel:"custrecord_ei_sending_method_channel"}},i=e.getDAO(r);return{create:function(e){return i.create(e)},getSendingMethods:function(e){var r=[],i=[];return e.edocumentstandard&&(i.length>0&&i.push("and"),i.push(["custrecord_psg_ei_edoc_standard","is",e.edocumentstandard])),e.sendingchannel&&(i.length>0&&i.push("and"),i.push(["custrecord_ei_sending_method_channel","is",e.sendingchannel])),t.create({type:n,columns:[],filters:i}).run().each((function(e){var t={eDocumentStandard:e.getValue({name:"custrecord_psg_ei_edoc_standard"}),sendingScript:e.getValue({name:"custrecord_ei_sending_method_script"}),sendingChannel:e.getValue({name:"custrecord_ei_sending_method_channel"})};return r.push(t),!0})),r}}}.apply(t,r))||(e.exports=i)},8948:(e,t,n)=>{var r,i;r=[n(5239),n(1303)],void 0===(i=function(e,t){var n={entityid:"entityid",internalid:"internalid"},r={recordType:"vendor",fieldMap:n},i=e.getDAO(r);return{create:function(e){return i.create(e)},loadContacts:function(e){var n=[];return t.create({type:"contact",columns:["entityid","email"],filters:["internalid",t.Operator.ANYOF,e]}).run().each((function(e){return n.push(e),!0})),n},loadEIRecipients:function(e){var n=[];return t.create({type:"customrecord_psg_ei_email_recipient_vend",columns:[t.createColumn({name:"email",join:"custrecord_psg_v_ei_email_recipient_cont"})],filters:["custrecord_psg_ei_email_recipient_vendor","is",e]}).run().each((function(e){var t=e.getValue({name:"email",join:"custrecord_psg_v_ei_email_recipient_cont"});return n.push(t),!0})),n},getVendorsUsingSenderDomain:function(e,r){var i=[],s=t.create({type:t.Type.VENDOR,columns:[n.entityid]}),a=[];return a.push(t.createFilter({name:"custentity_edoc_sender_domain",operator:t.Operator.IS,values:e})),r&&a.push(t.createFilter({name:"internalid",operator:t.Operator.NONEOF,values:r})),s.filters=a,s.run().each((function(e){return i.push(e),!0})),i},getVendorsUsingWebServiceIdentifier:function(e,r){var i=[],s=t.create({type:t.Type.VENDOR,columns:[n.entityid]}),a=[];return a.push(t.createFilter({name:"custentity_edoc_ws_id",operator:t.Operator.IS,values:e})),r&&a.push(t.createFilter({name:"internalid",operator:t.Operator.NONEOF,values:r})),s.filters=a,s.run().each((function(e){return i.push(e),!0})),i},getVendorUsingIdentifierAndSender:function(e,r){var i=[];i.push(["custentity_edoc_ws_sender",t.Operator.IS,r]),i.push("OR"),i.push(["internalid",t.Operator.IS,r]);var s=[];s.push(["custentity_edoc_ws_id",t.Operator.IS,e]),s.push("AND"),s.push(["custentity_psg_ei_entity_edoc_standard",t.Operator.NONEOF,"@NONE@"]),s.push("AND"),s.push(i);var a=t.create({type:t.Type.VENDOR,filters:s,columns:[n.internalid,n.entityid]}),o=[];return a.run().each((function(e){return o.push(e),!0})),o}}}.apply(t,r))||(e.exports=i)},5239:(e,t,n)=>{var r,i;r=[n(7266)],void 0===(i=function(e){function t(t){var n=t.recordType,r=t.fieldMap,i=t.subListMaps;function s(e){for(var t=e.record,n=e.subList,r=e.subListMap,i=t.getLineCount({sublistId:n}),s=[],a=0;a<i;a++){var o={};for(var u in r)o[u]=t.getSublistValue({sublistId:n,fieldId:r[u],line:a});s.push(o)}return s}this.create=function(t,i,s){var a=!1,o=!1,u=!1;i&&i.hasOwnProperty("isDynamic")&&(a=i.isDynamic);var c=e.create({type:n,isDynamic:a});for(var d in r){var l=r[d];c.setValue(l,t[d])}return s&&(s.hasOwnProperty("enableSourcing")&&(o=s.enableSourcing),s.hasOwnProperty("ignoreMandatoryFields")&&(u=s.ignoreMandatoryFields)),c.save({enableSourcing:o,ignoreMandatoryFields:u})},this.retrieve=function(t){var a,o={subLists:{}},u=e.load({type:n,id:t});for(var c in r)o[c]=u.getValue(r[c]);var d=o.subLists;for(var l in i)a={record:u,subList:l,subListMap:i[l]},d[l]=s(a);return o},this.retreiveNSRecord=function(t){return e.load({type:n,id:t})}}return{getDAO:function(e){return new t(e)}}}.apply(t,r))||(e.exports=i)},3623:(e,t)=>{var n;void 0===(n=function(){var e,t=!0;return{consolidateValidationResults:function(n){for(var r=!0,i=[],s=0;s<n.length;s++){var a=n[s];r=r&&a.isValid(),a.getMessage()&&i.push(a.getMessage())}t=r,e=i.join("\n")},isSuccessful:function(){return t},getMessage:function(){return e}}}.apply(t,[]))||(e.exports=n)},3776:(e,t,n)=>{var r,i;r=[n(7903)],void 0===(i=function(e){var t;return{setString:function(n){if(!n)throw e.create({name:"REQUIRED_PARAM_MISSING",message:"Parameter of method setString of String Formatter must not be null or undefined."});t=n},replaceParameters:function(e){for(var n in e){var r=new RegExp("\\{"+n+"\\}","g");t=t.replace(r,e[n])}},toString:function(){return t.toString()}}}.apply(t,r))||(e.exports=i)},9502:(e,t,n)=>{var r,i;r=[n(5389),n(6834)],void 0===(i=function(e,t){var n;function r(r){n||(n=e.getCurrentUser().getPreference("LANGUAGE")),r=(r=r.toLowerCase()).replace(new RegExp(".".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"_");var i="";try{i=t.get({collection:"custcollection_ei_translations",key:r,locale:n})()}catch(e){log.error(e.name,e.message+"\n"+e.stack)}return i}return{getString:r,getStringMap:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n];t[i]=r(i)}return t},setLocale:function(e){n=e}}}.apply(t,r))||(e.exports=i)},3899:(e,t)=>{var n;void 0===(n=function(){function e(){var e,t;this.setValidity=function(t){e=t},this.isValid=function(){return e},this.setMessage=function(e){t=e},this.getMessage=function(){return t}}return{create:function(){return new e}}}.apply(t,[]))||(e.exports=n)},7903:t=>{"use strict";t.exports=e},7266:e=>{"use strict";e.exports=t},5389:e=>{"use strict";e.exports=n},1303:e=>{"use strict";e.exports=r},6834:e=>{"use strict";e.exports=i}},a={},function e(t){var n=a[t];if(void 0!==n)return n.exports;var r=a[t]={exports:{}};return s[t](r,r.exports,e),r.exports}(6228);var s,a}));